# Slide Producer Script

## 概要

このスクリプトは、指定したPowerPointファイルをテンプレートとして、新しいプレゼンテーションファイル (`試験向け.pptx` と `運用向け.pptx`) を作成します。スライドやテキストボックスは指定された条件に基づき自動管理されます。新しいプレゼンテーションファイルは、読み取り専用として保存されます。

## 必要条件

- Windowsオペレーティングシステム
- Windows PowerShell
- Microsoft PowerPoint (COMオブジェクトの利用にはインストール済みである必要があります)

## 使用法

### スクリプトの配置

スクリプトファイルを、使用するPowerPointプレゼンテーションファイルと同じディレクトリに置きます。

### スクリプトの実行

PowerShellでスクリプトを実行します。

### ファイルの選択

スクリプト実行時に、現在のディレクトリに存在するPowerPointファイル一覧が表示されます。
複数のPowerPointファイルが存在する場合、使用したいテンプレートファイルの番号を入力してください。

### 注意点

スクリプト実行中に他の作業を行うと、操作に影響を及ぼす可能性があります。
一部の操作にはユーザインタフェースの自動化が含まれ、実行中はキー入力やウィンドウのフォーカスに依存します。

## Constants セクションについて

スクリプト内で定数として以下が定義されています:

- `$TYPE1` = "試験向け"
- `$TYPE2` = "運用向け"
- `$BOTH` = "試験/運用向け"

これらの定数はスライドとテキストボックスの検出および処理条件に使用され、各プレゼンテーションタイプの設定を定義します。

## マスタープレゼンテーションのテキストボックスに関するルール

マスタープレゼンテーションには、特定のテキストを含むテキストボックスが必要です。ルールは以下の通りです:

- 各スライドは`試験向け`、`運用向け`、もしくは`試験/運用向け`のみの文字を含むテキストボックスを含んでいること。
- 複数の対応するテキストボックスがスライド内に存在する場合、該当スライドは削除されます。
- 複数の対応するテキストボックスが存在するスライドが2枚以上ある場合、ターミナルに警告メッセージが表示されます。

## 注意事項

### 動作環境

このスクリプトはWindows環境でのみ動作確認済みです。

### エラーハンドリング

スクリプト実行中にエラーが発生した場合、エラー情報がコンソールに表示されます。
エラーの詳細を確認し、必要に応じてスクリプトを修正してください。

### フォーカスの重要性

ウィンドウのアクティブ化とキーの送信にはウィンドウが正しくアクティブ化される必要があります。
他のウィンドウにフォーカスが移ると操作が正常に行われなくなります。

## ライセンス

このユーザースクリプトの著作権は、NTT DOCOMO INC. に帰属します。

### 使用条件

NTT DOCOMO INC. およびそのグループ各社の社員は、本スクリプトを業務で使用できます。
また、以下の条件の下で、改変および配布も可能です：

- 改変や配布の場合、同じ著作権表示（このライセンス文書）を保持すること。
- 改変したスクリプトには、変更が加えられている旨を明示すること。
- 商業的利用はNTT DOCOMO INC.の許可が必要です。

自己の責任において本スクリプトを使用してください。

### 免責事項

本スクリプトは「現状のまま」提供され、いかなる保証もありません。NTT DOCOMO INC. は、本スクリプトの使用に関連して発生するいかなる損害についても責任を負いません。

## 貢献

バグ報告や機能要求を受け付けております。意見や貢献がある場合はPlull Requestをお願いします。
