# Slide Producer Script

## 概要

このスクリプトは、現在のディレクトリに存在するPowerPointファイルの中から、指定したファイルをテンプレートとして新しいプレゼンテーションファイル (`試験向け.pptx` と `運用向け.pptx`) を作成し、指定された条件に基づいてスライドやテキストボックスを管理するプロセスを自動化します。
また、新たなプレゼンテーションファイルは読み取り専用として保存します。

## 必要条件

- Windowsオペレーティングシステム
- windows PowerShell
- Microsoft PowerPoint (COMオブジェクトのためにインストール済み)

## 使用法

1. **スクリプトの配置**:
   - スクリプトファイルをPowerPointプレゼンテーションファイルと同じディレクトリに置きます。

2. **スクリプトの実行**:
   - スクリプトを実行します。

3. **ファイルの選択**:
   - スクリプト実行時に、現在のディレクトリに存在するPowerPointファイル一覧が表示されます。
   - 使用するテンプレートファイルの番号を入力してください。

4. **注意点**:
   - 一部の操作にはユーザインタフェースの自動化が含まれており、実行中はキー入力やウィンドウのフォーカスに依存します。
   - 他の作業を行うと操作を妨げる可能性があります。

## Constants セクションについて

- スクリプト内で定数として定義されている以下の識別子を使用します:
  - `$TYPE1 = "試験向け"`
  - `$TYPE2 = "運用向け"`
  - `$BOTH = "試験/運用向け"`

これらの定数は、スライドとテキストボックスの検出および処理条件に使用され、各プレゼンテーションタイプの適切な設定を定義します。

## マスタープレゼンテーションのテキストボックスに関するルール

マスタープレゼンテーション (`$masterPresentation`) には、特定のテキストを含むテキストボックスが必要です。
以下のルールを満たしている必要があります:

- `試験向け`、`運用向け`、または`試験/運用向け`のみのテキストボックスを含んでいる必要があります。
- 複数の対応するテキストボックスがスライド内に存在する場合、当該スライドは削除されます。
- 複数の対応するテキストボックスが存在するスライドが2枚以上ある場合、ターミナルでメッセージを表示します。
    - 1枚はマスタープレゼンテーションのルール説明用のスライドを想定しています。
    - 2枚目移行はタグ付けを誤っている可能性があるため、メッセージを表示するようにしています。

## 注意事項

- **動作環境**:
  - 本スクリプトはWindows環境でのみ動作確認がされています。
  - 管理者権限が必要な場合があります。

- **エラーハンドリング**:
  - スクリプト実行中にエラーが発生した場合、その内容がコンソールに表示されます。エラーの詳細を確認し、必要に応じてスクリプトを修正してください。

- **フォーカスの重要性**:
  - ウィンドウのアクティブ化とキーの送信は、目的のウィンドウが正しくアクティブ化される必要があります。フォーカスが他のウィンドウに移ると操作が正常に行われません。

## ライセンス

このユーザースクリプトの著作権は、NTT DOCOMO INC. に帰属します。

### 使用条件

NTT DOCOMO INC. および NTT DOCOMO INC.のグループ各社の社員は、本スクリプトを業務上で使用することができます。

また、以下に示す条件の下での改変および配布も許可されています：

スクリプトの改変や配布を行う場合、同じ著作権表示（このライセンス文書）を保持すること。
改変したスクリプトには、変更が加えられている旨を明示すること。
NTT DOCOMO INC. の許可なく、本スクリプトを商業的に利用することはできません。 利用者は、自己の責任において本スクリプトを使用するものとします。

### 免責事項

本スクリプトは「現状のまま」提供されており、明示または黙示のいかなる保証もありません。 NTT DOCOMO INC. は、本スクリプトの使用に起因するいかなる損害についても責任を負わないものとします。

## 貢献

バグ報告や機能要求を受け付けていますので、ご意見や貢献がある場合はプルリクエストをお願いします。
